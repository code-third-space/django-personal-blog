{% extends 'bloggings/base.html' %}

{% block content %}
{% load static %}
<link type="text/css" rel="stylesheet" href="{% static 'bloggings/cssBlogAll.css' %}">

<div class="container py-4">
    <div class="row mb-4">
        <div class="col-12 text-center">
            <h2 class="display-5 fw-bold">所有博客</h2>
            <p class="lead text-muted">浏览我们的全部博客内容</p>
            <hr class="my-4" style="width: 50px; height: 3px; background-color: #0d6efd; border: none; margin: 20px auto;">
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">博客列表</h5>
                    <span class="badge bg-primary rounded-pill">{{ blog_all_list.paginator.count }} 篇</span>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 30%">标题</th>
                                    <th style="width: 12%">城市</th>
                                    <th style="width: 12%">类别</th>
                                    <th style="width: 12%">国家</th>
                                    <th style="width: 14%">日期</th>
                                    <th style="width: 20%">图像</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if blog_all_list %}
                                {% for blog in blog_all_list %}
                                <tr class="blog-row">
                                    <td>
                                        <a href="/blog_detail/{{blog.id}}/" class="text-decoration-none blog-title">
                                            {{blog.blog_title}}
                                        </a>
                                    </td>
                                    <td>
                                        <span class="badge bg-info text-dark">{{blog.city_name}}</span>
                                    </td>
                                    <td>
                                        <span class="badge blog-type-badge">{{blog.blog_type}}</span>
                                    </td>
                                    <td>
                                        <span class="badge bg-secondary">{{blog.blog_countries}}</span>
                                    </td>
                                    <td>
                                        <small class="text-muted">{{blog.created_date|date:"Y-m-d"}}</small>
                                    </td>
                                    <td>
                                        <div class="blog-image-container">
                                            {% if blog.picture %}
                                            <img src="{{blog.picture.url}}" class="blog-image" alt="{{blog.blog_title}}">
                                            {% else %}
                                            <div class="no-image-placeholder">
                                                <i class="bi bi-image"></i>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                                {% else %}
                                <tr>
                                    <td colspan="6" class="text-center py-5">
                                        <div class="empty-state">
                                            <i class="bi bi-journal-x" style="font-size: 3rem; color: #6c757d;"></i>
                                            <p class="mt-3 mb-0">暂无博客内容</p>
                                        </div>
                                    </td>
                                </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if blog_all_list %}
    <div class="row">
        <div class="col-12">
            <nav aria-label="博客分页">
                <ul class="pagination justify-content-center">
                    <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
                        <a class="page-link" 
                        href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}javascript:void(0);{% endif %}">
                            <i class="bi bi-chevron-left"></i> 上一页
                        </a>
                    </li>
                    {% for num in blog_all_list.paginator.page_range %}
                        <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                        </li>
                    {% endfor %}
                    <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
                        <a class="page-link" 
                        href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}javascript:void(0);{% endif %}">
                            下一页 <i class="bi bi-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    {% endif %}
</div>

<style>
    .blog-row {
        transition: background-color 0.2s;
    }
    
    .blog-row:hover {
        background-color: rgba(13, 110, 253, 0.05);
    }
    
    .blog-title {
        color: #0d6efd;
        font-weight: 500;
        transition: color 0.2s;
    }
    
    .blog-title:hover {
        color: #0a58ca;
        text-decoration: underline !important;
    }
    
    .blog-image-container {
        width: 100px;
        height: 80px;
        overflow: hidden;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .blog-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s;
    }
    
    .blog-row:hover .blog-image {
        transform: scale(1.1);
    }
    
    .no-image-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #f8f9fa;
        color: #6c757d;
    }
    
    .blog-type-badge {
        background-color: #28a745;
        color: white;
    }
    
    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem;
    }
    
    .pagination {
        margin-top: 2rem;
    }
    
    .pagination .page-link {
        color: #0d6efd;
        border-color: #dee2e6;
    }
    
    .pagination .page-item.active .page-link {
        background-color: #0d6efd;
        border-color: #0d6efd;
    }
    
    .pagination .page-item.disabled .page-link {
        color: #6c757d;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 为不同类型的博客设置不同的颜色
        const typeColors = {
            '技术': '#0d6efd',
            '财经': '#28a745',
            '新闻': '#dc3545',
            '阅读': '#6f42c1',
            '风景': '#20c997',
            '物品': '#fd7e14'
        };
        
        // 为每个博客类型标签设置颜色
        document.querySelectorAll('.blog-type-badge').forEach(badge => {
            const typeName = badge.textContent.trim();
            if (typeColors[typeName]) {
                badge.style.backgroundColor = typeColors[typeName];
            }
        });
    });
</script>
{% endblock %}
