{% extends 'bloggings/base.html' %}

{% block content %}
{% load static %}
<link type="text/css" rel="stylesheet" href="{% static 'bloggings/cssBlogdisplay.css' %}">

<!-- 第一部分 -->
<div id="content-one" class="container-fluid" style="margin: 0 40px; height: 500px;">
    <div class="row">
        <!-- 留空部分 -->
        <!--<div class="col-md-3"></div>-->
        <!-- 轮播部分 -->
        <div class="col-md-12">
            <div id="demo1" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    {% if blog_list %}
                    {% for blog in blog_list %}
                    <button type="button" data-bs-target="#demo1" 
                        data-bs-slide-to="{{ forloop.counter0 }}"
                        class="{% if forloop.first %}active{% endif %}">
                    </button>
                    {% endfor %}
                    {% endif %}
                </div> 
                <div class="carousel-inner">
                    {% if blog_list %}
                    {% for blog in blog_list %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <div class="d-flex" style="align-items: center; height: 500px;">
                            <div class="card" style="width: 400px;">
                                <div class="card-body">
                                    <h4 class="card-title">{{ blog.blog_title }}</h4>
                                    <p class="card-text">{{ blog.blog_detail_one|truncatechars:120}}</p>
                                    <a class="btn btn-primary" href="/blog_detail/{{blog.id}}">点击开始查看</a>
                                </div>
                            </div>
                            {% if blog.picture and blog.picture.url %}
                            <img src="{{ blog.picture.url }}" alt="图片" 
                                class="d-block mx-auto img-fluid" style="width: 60%;">
                            {% else %}
                            <img class="card-img-top" src="/blog_ment/blog_project/media/picture/fail_default.png"
                                class="d-block mx-auto img-fluid" style="width: 60%;">
                            {% endif %}
                        </div>
                        <button type="button" class="carousel-control-prev" data-bs-target="#demo1" data-bs-slide="prev"
                            style="margin-left: 400px;">
                            <span class="carousel-control-prev-icon"></span>
                        </button>
                        <button type="button" class="carousel-control-next" data-bs-target="#demo1" data-bs-slide="next"
                            style="margin-right: 40px;">
                            <span class="carousel-control-next-icon"></span>
                        </button>
                    </div>
                    {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <script>
        let carouselInterval;
        const carousel = document.getElementById('demo1');
        const bsCarousel = new bootstrap.Carousel(carousel, {
            interval: false // 禁用 Bootsrtap 默认的自动轮播， 自己控制
        });

        // 启动自动轮播
        function startCarousel() {
            if (!carouselInterval) {
                carouselInterval = setInterval(() => {
                    bsCarousel.next();
                }, 3000);
            }
        }

        // 停止自动轮播 
        function pauseCarousel() {
            if (carouselInterval) {
                clearInterval(carouselInterval);
                carouselInterval = null;
            }
        }

        // 鼠标悬停时显示特定图像
        function showImage(index) {
            bsCarousel.to(index); // 激活指定索引的幻灯片
            pauseCarousel(); // 暂停自动轮播
        }

        // 鼠标移开时恢复自动轮播
        function resumeCarousel() {
            startCarousel();
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            startCarousel();

            // 添加鼠标悬停时间处理
            carousel.addEventListener('mouseenter', pauseCarousel);
            carousel.addEventListener('mouseleave', startCarousel);
        });

        // 为图片显示和隐藏功能添加事件监听器
        document.querySelectorAll('[onmouseover]').forEach(element => {
            const imageId = element.getAttribute('onmouseover').match(/'[^']+)'/)[1];
            element.onmouseover = () => showImage(imageId);
            element.onmouseout = () => hideImage(imageId);
        });
    </script>
</div>

<!-- 第二部分 -->
<div class="mt-3" id="content" style="margin: 0px;padding: 0;
    height: 650px; background-color: #477979;">
    <div class="row">
        <div class="col-md-6">
        <table class="table table-hover"
            style="height: 650px;">
        <thead>
            <tr style="height: 60px; line-height: 40px;">
                <td class="transparent">标题</td>
                <td class="transparent">地点</td>
                <td class="transparent">类型</td>
            </tr>
        </thead>
        <tbody>
        {% if blog_list %}
            {% for blog in blog_list %}
            <tr>
                <td class="text-left transparent"
                    onmouseover="showImage('image-{{ blog.id }}')"
                    onmouseout="hideImage('image-{{ blog.id }}')">
                    <a href="/blog_detail/{{blog.id}}/" class="text-decoration-none"
                        style="color: #fdf5f6;">
                        {{blog.blog_title}}
                    </a>
                </td>
                <td class="text-warning text-center transparent">{{ blog.city_name }}</td>
                <td class="text-right transparent" style="color: #7fff00;">
                    {{ blog.type_name}}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan=""> 没有可用的博客</td>
            </tr>
        {% endif %}
        </tbody>
        </table>   
        </div>
        <div class="col-md-6">
            <table class="table table-hover radius-1">
                <thead>
                    <tr style="height: 60px; line-height: 40px">
                    <td class="transparent">图像</td>
                    </tr>
                </thead>
                <tbody>
                {% if blog_list %}
                {% for blog in blog_list %}
                    <tr style="height: 0; display: table-row;">
                    <td class="transparent transparent" 
                        style="padding: 0; border: none;">
                    {% if blog.picture %}
                    <img id="image-{{ blog.id }}" src="{{ blog.picture.url }}" alt="图片展示" 
                    style="max-width: 660px;max-height: 580px; display: none; border-radius: 20px;">
                    {% endif %}
                    </td>
                    </tr>
                {% endfor %}
                {% endif %}
                </tbody>
            </table>
        </div>
    <script>
        function showImage(imageId) {
            var img = document.getElementById(imageId);
            if (img) {
                img.style.display = 'block';
            }
        }
        
        function hideImage(imageId) {
            var img = document.getElementById(imageId);
            if (img) {
                img.style.display = 'none';
            }
        }
    </script>
    </div>
</div>
<!-- 第三部分 -->
<div id="content-two" style="width: 96%;margin: 0px 40px;padding: 0;">
    <hr style="border-width: 5px; border-radius: 5px; color: #DAA520;">
    <h2 class="alert alert-primary text-center" style="border-radius: 10px;">↓修改中↓</h2>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">技术 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_a_blogs %}
            {% for blog in type_a_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <hr/>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">财经 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_b_blogs %}
            {% for blog in type_b_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <hr/>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">新闻 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_c_blogs %}
            {% for blog in type_c_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <hr/>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">阅读 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_d_blogs %}
            {% for blog in type_d_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <hr/>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">风景 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_e_blogs %}
            {% for blog in type_e_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <hr/>
    <div style="height: 480px;">
        <h3 style="margin-bottom: 40px; margin-left: 50px; margin-top: 20px;">货品 Blogs</h3>
        <div style="height: 400px; display: flex; flex-wrap: wrap; gap: 55px;">
            {% if type_f_blogs %}
            {% for blog in type_f_blogs %}
            <div class="card" style="width: 22%;height: 360px;">
                {% if blog.picture and blog.picture.url %}
                <img class="card-img-top" src="{{ blog.picture.url }}" style="width: 100%;height: 40%;">
                {% else %}
                <img class="card-img-top" src="/media/picture/fail_default.png" 
                    style="width: 100%;height: 40%;">
                {% endif %}                <div class="card-body">
                    <h5 class="card-title" style="height: 20%;">{{ blog.blog_title | truncatechars:20 }}</h5>
                    <p class="card-text">{{ blog.blog_detail_one | truncatechars:25 }}</p>
                    <a class="btn btn-info" style="margin-top: 30px;"
                        href="/blog_detail/{{ blog.id }}">点击查看</a>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</div>
<p class="text-align:center">已到底了<strong><a href="#content-one">返回</a></strong></p>
{% endblock %}